<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PixiJS Live2D Example</title>
  <script src="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pixi.js@6.5.2/dist/browser/pixi.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/index.min.js"></script>
</head>
<body>
  <div>
    <textarea id="textToSpeak" placeholder="在这里输入要转换的文本..."></textarea>
    <button id="speakButton">朗读</button>
  </div>
  <canvas id="canvas"></canvas>
  <script>
      const url = 'https://cdn.jsdelivr.net/gh/guansss/pixi-live2d-display/test/assets/shizuku/shizuku.model.json';
      (async function main() {
        const app = new PIXI.Application({
          view: document.getElementById("canvas"),
          autoStart: true,
          resizeTo: window
        });

        const model = await PIXI.live2d.Live2DModel.from(url);

        app.stage.addChild(model);

        model.scale.set(0.6);

        console.log(model);

        const updateFn = model.internalModel.motionManager.update;
  
        model.internalModel.motionManager.update = () => {
          updateFn.call(model.internalModel.motionManager);
          
          // overwrite the parameter after calling original update function
          model.internalModel.coreModel.setParamFloat('PARAM_MOUTH_OPEN_Y', 0.5);
        }
      })();

  </script>
</body>
</html>
